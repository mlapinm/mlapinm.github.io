$(() => {
    let log1 = $('.log1')
    let log2 = $('.log2')
    let grid = $('.grid')
    let max = 100 * 100
    let maxRow = 100
    let mousedown = false
    let mclear = false
    let mcolor = true
    mcolor = true

    let figs = ['0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009999999999999999000000000000000000000000000000000000000000000000000000000000000000000000000000000999999999999999999999999900000000000000000000000000000000000000000000000000000000000000000000000009999990000000000000999999999999900000000000000000000000000000000000000000000000000000000000000000009990000000000000000000000099999999990000000000000000000000000000000000000000000000000000000000000009990000000000000000000000000000099999999000000000000000000000000000000000000000000000000000000000009990000000000000000000000000000000999999999000000000000000000000000000000000000000000000000000000000990000000000000000000000999999999999999999000000000000000000000000000000000000000000000000000000000999000000000000000000099999999999999000000000000000000000000000000000000000000000000000000000000000099000000000000000000999999000000000000000000000000000000000000000000000000000000000000000000000000099000000000000000009999900000000000000000000000000000000000000000000000000000000000000000000000000009900000000000000099990000000000000000000000000000000000000000000000000000000000000000000000000000000990000000000000099990000000000000000000000000000000000000000000000000000000000000000000000000000000999000000000000099900000000000000000000000000000000000000000000000000000000000000000000000000000000099000000000000009900000000000000000000000000000000000000000000000000000000000000000000000000000000009900000000000009990000000000099999999999999900000000000000000000000000000000000000000000000000000009990000000000009990000000000009999999999999999999000000000000000000000000000000000000000000000000000990000000000009990000000000009900000000000099999999000000000000000000000000000000000000000000000000099000000000009990000000000000990000000000000000999990000000000000000000000000000000000000000000000009900000000000990000000000000099000000000000000000999990000000000000000000000000000000000000000000000990000000000099000000000000009900000000000000000000999900000000000000000000000000000000000000000000990000000000099000000000000000990000000000000000000009999000000000000000000000000000000000000000000099000000000009900000000000000099000000000000000000000099990000000000000000000000000000000000000000009900000000009990000000000000009900000000000000000000000099900000000000000000000000000000000000000000990000000000990000000000000000999000000000000000000000009999000000000000000000000000000000000000000099000000000099000000000000000099900000000000000000000000099990000000000000000000000000000000000000009900000000009900000000000000000990000009999000000000000000999000000000000000000000000000000000000000990000000000990000000000000000099900999999999000000000000009990000000000000000000000000000000000000099000000000099000000000000000000999999990099990000000000000999000000000000000000000000000000000000009900000000009900000000000000000099999000000999900000000000009990000000000000000000000000000000000000990000000000990000000000000000000999900000009999000000000000099000000000000000000000000000000000000099000000000099000000000000000000099990000000009990000000000009990000000000000000000000000000000000009900000000009900000000000000000000999000000000099900000000000099000000000000000000000000000000000000990000000000990000000000000000000009000000000009990000000000009990000000000000000000000000000000000099000000000099900000000000000000000000000000000099000000000000099900000000000000000000000000000000009900000000009990000000000000000000000000000000009990000000000009990000000000000000000000000000000000999000000000099000000000000000000000000000000000999000000000000099000000000000000000000000000000000009900000000009900000000000000000000000000000000009900000000000009900000000000000000000000000000000000990000000000999000000000000000000000000000000000990000000000000990000000000000000000000000000000000099000000000009900000000000000000000000000000000099000000000000099000000000000000000000000000000000009900000000000999000000000000000000000000000000009900000000000009900000000000000000000000000000000000990000000000099900000000000000000000000000000000990000000000000990000000000000000000000000000000000099000000000000999000000000000000000000000000000099000000000000099000000000000000000000000000000000009990000000000009990000000000000000000000000000009900000000000009900000000000000000000000000000000000999000000000000099900000000000000000000000000000990000000000000990000000000000000000000000000000000009900000000000009999000000000000000000000000000999000000000000099000000000000000000000000000000000000990000000000000099900000000000000000000000000099000000000000009900000000000000000000000000000000000099000000000000000999900000000000000000000000099900000000000000990000000000000000000000000000000000009990000000000000009999000000000000000000000009900000000000000099000000000000000000000000000000000000999000000000000000099990000000000000000000009990000000000000009900000000000000000000000000000000000009900000000000000000999990000000000000000009990000000000000000990000000000000000000000000000000000000999000000000000000009999900000000000000009990000000000000000999000000000000000000000000000000000000009900000000000000000009999990000000000009990000000000000000099000000000000000000000000000000000000000999000000000000000000009999999999999999990000000000000000009900000000000000000000000000000000000000099900000000000000000000009999090999999900000000000000000009900000000000000000000000000000000000000000999000000000000000000000000000000000000000000000000000000990000000000000000000000000000000000000000009990000000000000000000000000000000000000000000000000000999000000000000000000000000000000000000000000999000000000000000000000000000000000000000000000000000099000000000000000000000000000000000000000000009999000000000000000000000000000000000000000000000000099900000000000000000000000000000000000000000000099999000000000000000000000000000000000000000000000009900000000000000000000000000000000000000000000000999990000000000000000000000000000000000000000000009900000000000000000000000000000000000000000000000000999999000000000000000000000000000000000000000009990000000000000000000000000000000000000000000000000009999999000000000000000000000000000000000000009990000000000000000000000000000000000000000000000000000099999999990000000000000000000000000000000099990000000000000000000000000000000000000000000000000000000000099999999900000000000000000000000009999900000000000000000000000000000000000000000000000000000000000000000909999999999000000000000000099990000000000000000000000000000000000000000000000000000000000000000000000009999999999999000000000099900000000000000000000000000000000000000000000000000000000000000000000000000000000099999999999999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000099999999999999900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000']

    let squares = []
    let isquares = []

    $('.bcopy').click(() => {
        let text = ''

        isquares.forEach(e => {
            text += e.toString(16)
        })
        navigator.clipboard.writeText(text)
    })


    $('.bclear').click(() => {
        mclear = true
        $('.bclear').css('border-color', 'blue')
        $('.bdraw').css('border-color', 'black')
    })

    $('.bdraw').click(() => {
        mclear = false
        $('.bdraw').css('border-color', 'blue')
        $('.bclear').css('border-color', 'black')
    })

    let set_color = (n) => {
        console.log(n)
        isquares[n] = 3
        let pfig = [n]
        console.log(pfig.slice(0, 10))
        // return
        let k = 1
        while(k == 1){
            k = 0
            bfig = []
            pfig.forEach((e) => {
                let pts = [
                    e - maxRow,
                    e - maxRow + 1,
                    // e + 1,
                    // e + maxRow + 1,
                    // e + maxRow,
                    // e + maxRow - 1,
                    // e - 1,
                    // e - maxRow - 1
                ]
                pts.forEach(u => {
                    if(isquares[u] == 0){
                        isquares[u] = 3
                        bfig.push(u)
                        k = 1
                    }
                })
            })
            pfig = pfig.concat(bfig)
            // k = 0
        }
        pfig.sort()
        console.log(pfig.slice(0, 10))
        pfig.forEach(e => {
            squares[e].addClass('blue')
        })
    }

    let set_fig = (fig) => {
        let k = 0
        fig.split('').forEach(e => {
            if(e == 9){
                squares[k].addClass('clicked')
            }
            k += 1
        })

    }

    let make_grid = () => {
        let k = 0
        for(let i = 0; i < max; i++){
            let sq = $('<div></div>')
            sq.addClass('square')
    
            squares.push(sq)
            isquares.push(0)
            grid.append(sq)
            sq['numm'] = k
            k += 1
        }

        squares.forEach((sq) => {
            sq.mousemove((e) => {
                let d = $(e.target)
                if(e.which == 0){
                    return
                }
                if(mousedown){
                    let num = sq['numm']

                    if(mcolor){
                        // set_color(num)
                        return
                    }


                    let nums = [num, num+1, num+maxRow]
                    if(mclear){
                        nums = nums.concat([num,, num+2*maxRow])
                    }
                    nums.forEach((e) => {
                        if(!mclear){
                            squares[e].addClass('clicked')
                            isquares[e] = 9
                        }else{
                            squares[e].removeClass('clicked')
                            isquares[e] = 0
                        }
                    })
                }
            })
            sq.mousedown(() => {
                mousedown = true
                if(mcolor){
                    let num = sq['numm']
                    console.log(num)
                    set_color(num)
                }
            })
            sq.mouseup(() => {
                mousedown = false
            })

        })
    
    }

    make_grid()
    set_fig(figs[0])
    console.log(0xff)

    log1.text(1)
    log2.text(1)
})


