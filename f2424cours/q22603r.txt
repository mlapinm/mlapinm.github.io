Model Selection and Train/Validation/Test Sets.Предположим, вы хотите решить, какая степень многочлена подойдет к набору данных. Чтобы определить какие свойства включить в обучающий алгоритм. Или предположим вы хотели бы выбрать параметр регуляризации лямбда для алгоритма обучения. Как вы делаете это? Этот процесс выбора модели расчета и в нашем обсуждении, о том как это сделать, мы говорили не только как разделить ваши данные на наборы обучения и тестов, но как переключить данные в то, что мы находили называлось обучающий, проверочный и набор тестирования. В этом видео мы увидим, что это за вещи, и как использовать их, чтобы сделать выбор модели. Мы уже много раз видели проблему чрезмерного "переобучения", в которой только потому, что алгоритм обучения хорошо вписывается в обучающий набор, это не значит, что это хорошая гипотеза. Обобщим: ошибка обучающего набора не является хорошим предсказателем для того, насколько хорошо гипотеза будет работать на новых примерах. Конкретно, если вам подходит какой-то набор параметров Theta0, theta1, theta2 и т. д. вашему тренировочному набору. Тогда тот факт, что ваша гипотеза хорошо работает на тренировочном списке это не имеет большого значения с точки зрения предсказания: насколько хорошо будет ваша гипотеза распространяться на новые примеры, которых не было в тренировочном наборе. И более общий принцип заключается в том, что когда-то ваш параметр - это то, что соответствует некоторому набору данных: может быть тренировочному набору, может быть, чему-то ещё. Тогда ошибка вашей гипотезы измеренная на том же наборе данных, такая же как ошибка обучения, это вряд ли будет хорошей оценкой вашей настоящей ошибкой распространения. То, как хорошо гипотеза будет распространяться на новые примеры. Теперь давайте рассмотрим проблему выбора модели. Допустим, вы пытаетесь выбрать, какую-то степень полинома для данных. Вы должны выбрать линейную функцию, квадратичную функцию, кубическую функцию. Вплоть до полинома 10-го порядка. как будто есть один дополнительный параметр в этом алгоритме, который я собираюсь обозначить d - степень полинома, который вы хотите выбрать. Так что, как если бы, в дополнение к theta параметрам, это как если бы есть еще один параметр, d, который вы пытаетесь определить, используя ваш набор данных. Итак, первый вариант - это d = 1, если вы подходите линейной функции. Мы можем выбрать d = 2, d = 3, вплоть до d =10. мы хотели бы соответствовать этому дополнительному параметру, который я обозначил d Т.е. если вы хотите выбрать модель, это значит выбрать степень полинома, выберите одну из этих 10 моделей. Подберите эту модель и получите оценку того, насколько хорошо гипотеза распространяется на новые примеры. Вот одна вещь, которую вы могли бы сделать. Что вы можете, это сначала взять свою первую модель и минимизировать ошибку обучения. И это даст вам некоторый параметр вектор theta. Затем вы можете взять свою вторую модель, квадратичную функцию, и подогнать это к своему тренировочному набору, и это даст вам немного другой параметр вектор theta. Для того, чтобы различать эти векторы параметров, я собираюсь использовать верхний индекс, theta(1) просто означает параметры, которые я получаю, подбирая эту модель к моим тренировочным данным. И theta(2) просто означает параметры, которые я подобрал для этой квадратичной функции для моих тренировочных данных и т.д. Подбирая кубическую модель, я получаю theta(3) и так до theta(10). И одну вещь, которую мы могли бы сделать, это взять эти параметры и посмотреть на ошибку теста Таким образом, я могу вычислить на моем тестовом наборе Jтест(theta1), Jтест(theta2), и т.д. Jтест(theta3), и т.д. Я собираюсь взять каждую из моих гипотез с соответствующими параметрами и просто измерить эффективность на тестовом наборе. Теперь я мог бы сделать следующее: выбрать одну из этих моделей, и посмотреть, какая модель имеет наименьшую ошибку на тестовом наборе. И пусть этот пример, которым я закончил, выбрал полином пятого порядка. Пока это кажется разумным. Но теперь, скажем, я хочу принять мою пятую гипотезу модель пятого порядка, и, скажем, я хочу спросить, насколько хорошо эта модель подходит? Одна вещь, которую я мог сделать, это посмотреть, насколько хорошо моя гипотеза полинома пятого порядка отработала на тестовом наборе. Но проблема в том, что это не будет справедливой оценкой того, насколько хорошо мои гипотезы подходят. И причина в том, что мы сделали: мы подгоняли этот дополнительный параметр d, вот эту степень полинома. Что соответствует этому параметру d, используя набор тестов, а именно: мы выбрали значение d, которое дало нам максимально возможное соответствие на тестовом наборе. Итак, эффективность моего параметра вектора theta(5) в тестовом наборе вероятно, это будет слишком оптимистичная оценка ошибки распространения. Поскольку я подгонял этот параметр d к своему тестовому набору, не справедливо оценить мою гипотезу на этом тестовом наборе, потому что я подбирая свои параметры для этого набора тестов, я выбрал степень d полинома, используя набор тестов. И так, моя гипотеза, вероятно, будет лучше на этом наборе тестов, чем на новых примерах, которые он не видел раньше, и это то, что меня действительно волнует. Итак, просто чтобы повторить: на предыдущем слайде, мы увидели, что если мы подходим к подбору параметров, вы знаете, скажем, theta0, theta1 и т.д., к некоторому тренировочному набору, тогда эффективность выбранной модели на тренировочном наборе не является прогнозирующей насколько хорошо гипотеза будет обобщена на новые примеры. Это потому, что эти параметры были вписаны в тренировочный набор, так что они, скорее всего, хорошо справятся с тренировками, даже если параметры не подходят для других примеров. И в процедуре, которую я только что описал в этой строке, мы просто сделали то же самое. И, в частности, то, что мы сделали - мы подгоняли этот параметр d к тестовому набору. И если подгонять параметр к тестовому набору, это означает, что выполнение гипотезы на этом тестовом наборе не может быть справедливой оценкой того, насколько хороша гипотеза на примерах, которые мы не видели раньше. Чтобы решить эту проблему, в настройке выбора модели, если мы хотим оценить гипотезу, вот, что мы обычно делаем вместо этого. Даём набор данных, вместо того, чтобы просто разделить на набор учебных и тестов, мы собираемся разделить его на три части. И первая часть будет, как обычно, называться тренировочным набором. Позвольте мне назвать это первой частью учебного набора. И вторую часть этих данных я собираюсь назвать набором перекрестной проверки. Перекрестная проверка... И перекрестная проверка, как CV. Иногда это также называется набором проверки, вместо набора перекрестной проверки. И тогда последнее можно назвать обычным тестовым набором. Довольно типичное соотношение как делить: 60% данных как ваш тренировочный набор, 20% набор перекрестной проверки и 20% тестовый набор. И эти цифры могут немного отличаться, но эта пропорция довольно типична. Наши тренировочные наборы теперь будут только 60% данных, набор перекрестной проверки, или наш набор проверки, будет иметь несколько примеров. Я собираюсь обозначить его Mcv. это количество примеров перекрестной проверки следуя нашему раннему соглашению об обозначениях, я собираюсь использовать x(i)cv,y(i)cv, для обозначения примера i перекрестной проверки. И, наконец, у нас также есть тестовый набор с нашими Mtest количеством тестовых примеров. Итак, теперь, когда мы определили проверку обучения (или перекрестную проверку) и тестовые примеры. Мы также можем определить ошибку обучения, ошибку перекрестной проверки и ошибку теста. Вот моя ошибка обучения, и я просто пишу это как Jобуч(theta) Это в значительной степени одно и то же. Это то же самое, что J (theta), который я писал так и вы знаете, это просто ошибка тренировочного набора, например, измерение тренировочного набора, а затем Jcv(theta), это почти то, что вы ожидаете, точно так же, как ошибка обучения, которую вы установили, измерьте ее на наборе данных перекрестной проверки, и вот моя ошибка тестового набора такая же, как и раньше. Поэтому, когда мы сталкиваемся с такой проблемой выбора модели как эта, то, что мы собираемся сделать вместо того, чтобы использовать набор тестов для выбора модели, мы вместо этого будем использовать набор проверки или набор перекрестной проверки для выбора модели. Конкретно, мы собираемся сначала принять нашу первую гипотезу, взять эту первую модель, и скажем, минимизировать перекрестную функцию, и это дало бы мне некоторый параметр вектор theta для новой модели. И, как и прежде, я собираюсь поставить верхний индекс 1 просто чтобы обозначить, что это параметр для новой модели. Мы делаем то же самое для квадратичной модели. Получим некоторый параметр вектора theta 2. Получим некоторый параметр, вектор параметров theta 3, и т.д. вплоть до theta(10) для полинома. И что я собираюсь сделать, вместо того, чтобы проверять эти гипотезы на тестовом наборе, вместо этого я собираюсь проверить их на множестве перекрестных проверок. и измерить Jcv(theta2) чтобы увидеть, насколько хорошо каждая из этих гипотез отработала на моем наборе перекрестной проверки. И я собираюсь выбрать гипотезу с наименьшей ошибкой перекрестной проверки. Итак, для этого примера полином 4-го порядка, имеет самую низкую ошибку перекрестной проверки. Так что в этом случае я собираюсь выбрать эту полиномиальную модель четвертого порядка. И, наконец, это означает, что этот параметр d, помните, d была степень полинома Таким образом, d = 2 , d = 3, вплоть до d = 10. Что мы сделали, так это выбрали параметру d и скажем, что d = 4. И мы сделали это, используя набор перекрестной проверки. И поэтому эта степень полинома, то есть параметр, больше не подходит для тестового набора и поэтому мы не сохранили набор тестов, и мы можем использовать набор тестов для измерения или оценки общей ошибки выбранной модели, этим алгоритмом. Итак, это был выбор модели и как вы можете разобрать ваши данные на тренировочные, проверочные и тестовые наборы. И используйте данные перекрестной проверки, чтобы выбрать модель и оценить это на тестовом наборе. Последнее замечание, я должен сказать, что в машинном обучения, на сегодняшний день, практически не так много людей, которые делают то. о чём я говорил: не очень хорошая идея - выбрать свою модель, используя набор тестов, а затем, используя тот же набор тестов, чтобы сообщить об ошибке, как если бы выбрать степень полинома на тестовом наборе, а затем сообщите об ошибке на тестовом наборе и считать это хорошей оценкой ошибки. К сожалению, такого рода практика - есть, многие делают это. Если у вас есть массивный, массивный тест, который, возможно, не страшная вещь, но многие практикующие, большинство практиков, которые обучают машину, склонны советовать против этого. И это считается лучшей практикой иметь отдельную проверку обучения и тестовый набор. Я только что предостерег вас от использования одних и те же данных для проверочного набора и для целей тестового набора. Вам нужен тренировочный набор и тестовый набор, и это хорошо, это практика, хотя вы увидите, что некоторые люди делают это. Но, если возможно, я бы порекомендовал вам лично так не делать.