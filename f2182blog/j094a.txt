1
00:00:00,789 --> 00:00:03,199
Welcome to Jeremy’s IT Lab.

2
00:00:03,199 --> 00:00:06,759
This is a free, complete course for the CCNA.

3
00:00:06,759 --> 00:00:10,580
If you like these videos, please subscribe
to follow along with the series.

4
00:00:10,580 --> 00:00:15,340
Also, please like and leave a comment, and
share the video to help spread this free series

5
00:00:15,340 --> 00:00:16,340
of videos.

6
00:00:16,340 --> 00:00:18,380
Thanks for your help.

7
00:00:18,380 --> 00:30:21,606
In this video we will talk about port security.

8
00:00:21,730 --> 00:00:26,520
Port security is a security feature on Cisco
switches that allows you to control what source

9
00:00:26,520 --> 00:00:31,250
MAC addresses are allowed on a switch port,
as well as how many MAC addresses are allowed

10
00:00:31,250 --> 00:00:32,910
on a switch port.

11
00:00:32,910 --> 00:00:38,590
It’s covered in exam topic 5.7, which says
you must be able to configure Layer 2 security

12
00:00:38,590 --> 00:00:44,630
features, including DHCP snooping, ARP inspection,
and port security.

13
00:00:44,630 --> 00:00:50,400
Those other two, DHCP snooping and ARP inspection,
will be covered in the next few videos.

14
00:00:50,400 --> 00:00:53,760
But for this video, we’ll focus on port
security.

15
00:00:53,760 --> 00:00:56,570
Here’s what we’ll cover in this video.

16
00:00:56,570 --> 00:01:00,550
First, I’ll introduce what port security
is.

17
00:01:00,550 --> 00:01:02,730
But knowing what it is isn’t enough.

18
00:01:02,730 --> 00:01:08,420
I’ll also explain why we use port security,
what security benefits it offers.

19
00:01:08,420 --> 00:01:12,580
And I’ll show you various port security
configuration commands, too.

20
00:01:12,580 --> 00:01:17,260
As always, watch until the end of the video
for an awesome bonus question from Boson Software’s

21
00:01:17,260 --> 00:01:24,020
ExSim for CCNA, my recommended practice exams
for the CCNA.

22
00:01:24,020 --> 00:01:25,890
First up, what is port security?

23
00:01:25,890 --> 00:01:30,260
Well, it’s a security feature of Cisco switches.

24
00:01:30,260 --> 00:01:34,799
It allows you to control which source MAC
address, or addresses, are allowed to enter

25
00:01:34,799 --> 00:01:35,799
a switchport.

26
00:01:35,799 --> 00:01:40,049
So, it’s configured on a per-interface basis.

27
00:01:40,049 --> 00:01:45,490
By the way, throughout this video I’ll probably
be using both terms, port and interface, but

28
00:01:45,490 --> 00:01:47,090
I mean the same thing.

29
00:01:47,090 --> 00:01:52,350
So, if a frame with an unauthorized source
MAC address enters the port, an action will

30
00:01:52,350 --> 00:01:54,070
be taken.

31
00:01:54,070 --> 00:01:58,250
There are a few possible actions that you
can configure, but the default action is to

32
00:01:58,250 --> 00:02:00,990
place the interface in an err-disabled state.

33
00:02:00,990 --> 00:02:04,990
In effect, this is like shutting down the
interface.

34
00:02:04,990 --> 00:02:09,040
Traffic will no longer be sent or received
by that interface.

35
00:02:09,040 --> 00:02:10,179
Let me demonstrate.

36
00:02:10,179 --> 00:02:14,500
PC1 is connected to SW1’s G0/1 interface.

37
00:02:14,500 --> 00:02:18,079
PC1’s MAC address is A.A.A.

38
00:02:18,079 --> 00:02:22,421
As you know, MAC addresses are actually 12
hexadecimal characters, but I’ll shorten

39
00:02:22,421 --> 00:02:25,409
them here to make it easier to read.

40
00:02:25,409 --> 00:02:31,701
The user of PC1 brought in his personal laptop
to work, that’s PC2, and it has a MAC address

41
00:02:31,701 --> 00:02:32,919
of B.B.B.

42
00:02:32,919 --> 00:02:39,720
The network admin has configured port security
on SW1’s G0/1 interface, so it will only

43
00:02:39,720 --> 00:02:46,549
allow frames with a source MAC address of
A.A.A to enter the G0/1 interface.

44
00:02:46,549 --> 00:02:53,209
When PC1 sends a frame, SW1 will check the
source MAC address and see that it is A.A.A,

45
00:02:53,209 --> 00:02:56,780
so it will forward it to the destination as
normal.

46
00:02:56,780 --> 00:03:02,670
But the user unplugs the cable from PC1 and
then connects it to the laptop, PC2.

47
00:03:02,670 --> 00:03:05,230
What will happen when PC2 sends a frame?

48
00:03:05,230 --> 00:03:12,510
Well, SW1 will check the source MAC address
and notice that it is B.B.B, but only A.A.A

49
00:03:12,510 --> 00:03:13,750
should be allowed.

50
00:03:13,750 --> 00:03:18,260
So, SW1 will place G0/1 in an err-disabled
state.

51
00:03:18,260 --> 00:03:22,309
It won’t send or receive data until you
enable the interface again.

52
00:03:22,309 --> 00:03:27,169
Now, as I said there are a few possible actions
that can be taken and I’ll explain the others

53
00:03:27,169 --> 00:03:31,819
later, but for now let’s assume the default
action of shutdown.

54
00:03:31,819 --> 00:03:37,079
So, noticing that his laptop isn’t able
to communicate over the network, the user

55
00:03:37,079 --> 00:03:42,090
unplugs the cable from his laptop and connects
it back to PC1.

56
00:03:42,090 --> 00:03:44,360
What happens when PC1 sends a frame?

57
00:03:44,360 --> 00:03:50,129
Well, the interface is still err-disabled,
so PC1 is also unable to communicate over

58
00:03:50,129 --> 00:03:51,870
the network.

59
00:03:51,870 --> 00:03:56,160
There are two ways to enable an interface
that has been disabled by port security, but

60
00:03:56,160 --> 00:03:58,139
I’ll cover those later.

61
00:03:58,139 --> 00:04:02,730
Okay let’s cover a few more points about
port security.

62
00:04:02,730 --> 00:04:07,779
When you enable port security on an interface
with the default settings, one MAC address

63
00:04:07,779 --> 00:04:09,219
is allowed.

64
00:04:09,219 --> 00:04:12,629
You can configure the allowed MAC address
manually if you want.

65
00:04:12,629 --> 00:04:16,920
But if you don’t configure it manually,
the switch will allow the first source MAC

66
00:04:16,920 --> 00:04:19,590
address that enters the interface.

67
00:04:19,590 --> 00:04:24,250
That MAC address will be allowed on the interface,
but all others will be unauthorized.

68
00:04:24,250 --> 00:04:28,580
However, you can change the maximum number
of MAC addresses allowed.

69
00:04:28,580 --> 00:04:33,060
Here’s one situation in which you should
increase the number of MAC addresses allowed

70
00:04:33,060 --> 00:04:34,270
on the port.

71
00:04:34,270 --> 00:04:40,380
Phone1 is directly connected to SW1, and PC1
is connected to phone1.

72
00:04:40,380 --> 00:04:44,900
The default port security setting, which allows
one MAC address, isn’t going to work in

73
00:04:44,900 --> 00:04:50,260
this situation, because both PC1 and phone1
are going to send traffic using their own

74
00:04:50,260 --> 00:04:54,110
MAC address as the source, so that’s two
MAC addresses.

75
00:04:54,110 --> 00:05:00,940
So, in this case let’s say we configured
SW1’s G0/1 interface to allow two MAC addresses.

76
00:05:00,940 --> 00:05:05,570
But we didn’t configure them manually, we
will let SW1 dynamically learn which two MAC

77
00:05:05,570 --> 00:05:07,160
addresses to allow.

78
00:05:07,160 --> 00:05:13,400
So, if phone1 sends a frame SW1 will add it
to the list of allowed MAC addresses and forward

79
00:05:13,400 --> 00:05:15,680
it as normal.

80
00:05:15,680 --> 00:05:22,410
Then if PC1 sends a frame, SW1 will also add
that one to the list and it will be forwarded.

81
00:05:22,410 --> 00:05:27,740
But now SW1’s G0/1 interface has reached
its maximum number of allowed MAC addresses,

82
00:05:27,740 --> 00:05:30,250
since we configured it as 2.

83
00:05:30,250 --> 00:05:34,940
If the interface is connected to another device
and it sends a frame, SW1 will shut down the

84
00:05:34,940 --> 00:05:38,850
interface because the source MAC address isn’t
authorized.

85
00:05:38,850 --> 00:05:42,170
Okay, in this introduced two main points.

86
00:05:42,170 --> 00:05:47,341
First, the default number of allowed MAC addresses
is one when you enable port security, but

87
00:05:47,341 --> 00:05:49,710
you can configure it to allow more.

88
00:05:49,710 --> 00:05:55,410
Second, the allowed MAC addresses can be manually
configured or dynamically learned.

89
00:05:55,410 --> 00:06:00,530
In this example, both were dynamically learned,
but for example we could have manually configured

90
00:06:00,530 --> 00:06:08,300
SW1 to allow C.C.C on G0/1, and then allow
it to dynamically learn A.A.A when PC1 sends

91
00:06:08,300 --> 00:06:09,370
a frame.

92
00:06:09,370 --> 00:06:14,410
So, if more than one MAC address is allowed,
they don’t all have to be manually configured

93
00:06:14,410 --> 00:06:20,050
or all have to be dynamically learned, a combination
is possible.

94
00:06:20,050 --> 00:06:24,780
You can probably imagine how port security
could be useful, but let me briefly explain.

95
00:06:24,780 --> 00:06:29,950
It’s useful because it allows network admins
to control which devices are allowed to access

96
00:06:29,950 --> 00:06:31,510
the network.

97
00:06:31,510 --> 00:06:35,560
Someone can’t just plug an unauthorized
device into a switchport and gain access to

98
00:06:35,560 --> 00:06:36,740
the network.

99
00:06:36,740 --> 00:06:40,000
However, MAC address spoofing is a simple
task.

100
00:06:40,000 --> 00:06:44,560
It’s easy to configure a device to send
frames with a different source MAC address.

101
00:06:44,560 --> 00:06:48,900
So, be aware that port security isn’t a
perfect solution in this regard.

102
00:06:48,900 --> 00:06:54,400
But, rather than manually specifying the MAC
addresses allowed on each port, port security’s

103
00:06:54,400 --> 00:07:00,210
ability to limit the number of MAC addresses
allowed on an interface is often more useful.

104
00:07:00,210 --> 00:07:07,240
For example, think back to the DHCP starvation
attack carried out in the day 48 lab video.

105
00:07:07,240 --> 00:07:12,780
The attacker spoofed thousands of fake MAC
addresses, and the DHCP server assigned IP

106
00:07:12,780 --> 00:07:18,000
addresses to those fake MAC addresses, exhausting
the DHCP pool.

107
00:07:18,000 --> 00:07:22,850
But not just that, switches can’t learn
an infinite number of MAC addresses, so the

108
00:07:22,850 --> 00:07:27,730
switch’s MAC address table can also become
full due to such an attack.

109
00:07:27,730 --> 00:07:31,830
Then the switch can no longer learn new MAC
addresses, and it will flood every packet

110
00:07:31,830 --> 00:07:33,870
it receives.

111
00:07:33,870 --> 00:07:38,050
Using port security to limit the number of
MAC addresses allowed on an interface can

112
00:07:38,050 --> 00:07:40,940
protect against such attacks.

113
00:07:40,940 --> 00:07:45,710
Both aspects of port security are useful:
controlling which MAC addresses are allowed

114
00:07:45,710 --> 00:07:49,841
and controlling how many MAC addresses are
allowed, so we’ll continue to look at both

115
00:07:49,841 --> 00:07:50,841
aspects.

116
00:07:50,841 --> 00:07:53,060
Let’s move on.

117
00:07:53,060 --> 00:07:58,490
Now, before going deeper into other areas
of port security, let’s cover the most basic

118
00:07:58,490 --> 00:08:00,260
configurations.

119
00:08:00,260 --> 00:08:05,150
Port security is enabled directly on the interface,
so I enter interface configuration mode for

120
00:08:05,150 --> 00:08:09,139
G0/1 and try the command SWITCHPORT PORT-SECURITY.

121
00:08:09,139 --> 00:08:15,710
However, it’s rejected with a message saying
that gigabitethernet0/1 is a dynamic port.

122
00:08:15,710 --> 00:08:17,130
What does that mean?

123
00:08:17,130 --> 00:08:22,710
To check I used SHOW INTERFACES G0/1 SWITCHPORT.
and here’s the answer.

124
00:08:22,710 --> 00:08:28,639
By default, switchports have an administrative
mode of dynamic auto, that’s the DTP command

125
00:08:28,639 --> 00:08:33,789
SWITCHPORT MODE DYNAMIC AUTO, I covered that
earlier in the course.

126
00:08:33,789 --> 00:08:38,759
Port security can be enabled on access ports
or trunk ports, but they must be statically

127
00:08:38,759 --> 00:08:41,249
configured as access or trunk.

128
00:08:41,249 --> 00:08:44,229
Dynamic auto and dynamic desirable are not
allowed.

129
00:08:44,229 --> 00:08:50,610
So, I used SWITCHPORT MODE ACCESS to configure
it as a static access port.

130
00:08:50,610 --> 00:08:56,430
Then I used SHOW INTERFACES G0/1 SWITCHPORT
again to check, and the administrative mode

131
00:08:56,430 --> 00:09:01,920
is now static access, so the SWITCHPORT PORT-SECURITY
command should work.

132
00:09:01,920 --> 00:09:07,400
And indeed it does, so port security is now
enabled on G0/1.

133
00:09:07,400 --> 00:09:11,620
When you use just this command, port security
is enabled with the default settings.

134
00:09:11,620 --> 00:09:15,439
Let’s check out those default settings.

135
00:09:15,439 --> 00:09:20,680
The command SHOW PORT-SECURITY INTERFACE,
followed by the interface name, is very useful.

136
00:09:20,680 --> 00:09:22,730
Let’s see what it shows.

137
00:09:22,730 --> 00:09:28,450
First, port security is enabled, and the port
status is secure-up.

138
00:09:28,450 --> 00:09:33,370
Secure-up just means port security is enabled,
and the interface is up.

139
00:09:33,370 --> 00:09:36,970
The default violation mode is shutdown, as
I said before.

140
00:09:36,970 --> 00:09:41,829
If an unauthorized frame enters the interface,
it will be err-disabled.

141
00:09:41,829 --> 00:09:44,620
Here are some default settings regarding the
timers.

142
00:09:44,620 --> 00:09:49,180
The aging time of 0 minutes means that the
addresses will never age out, there is no

143
00:09:49,180 --> 00:09:50,180
timer.

144
00:09:50,180 --> 00:09:52,809
But I’ll explain these later.

145
00:09:52,809 --> 00:09:55,910
Here we can see information about the MAC
addresses.

146
00:09:55,910 --> 00:10:01,779
The maximum is 1, currently it knows 0, 0
have been manually configured, and there are

147
00:10:01,779 --> 00:10:06,220
0 sticky MAC addresses, that’s also something
I’ll mention later.

148
00:10:06,220 --> 00:10:11,610
SW1 hasn’t received any traffic on this
interface yet, so the last source address

149
00:10:11,610 --> 00:10:14,829
is all 0s, with VLAN number 0.

150
00:10:14,829 --> 00:10:19,889
Finally, there have been no violations so
this counter here is at 0.

151
00:10:19,889 --> 00:10:25,490
Now I sent a ping from PC1 to R1, let’s
see what happens to the output of this command.

152
00:10:25,490 --> 00:10:29,319
I’ve highlighted the two places that have
changed.

153
00:10:29,319 --> 00:10:35,360
Total MAC addresses has changed from 0 to
1, because SW1 learned PC1’s MAC address.

154
00:10:35,360 --> 00:10:40,839
Note that the maximum is also 1, so SW1 won’t
be able learn any more MAC addresses on the

155
00:10:40,839 --> 00:10:42,059
interface.

156
00:10:42,059 --> 00:10:48,360
Also, the last source address has changed
to PC1’s MAC address, and the VLAN is 1,

157
00:10:48,360 --> 00:10:50,360
the default VLAN.

158
00:10:50,360 --> 00:10:55,019
Now let’s bring back PC2, and connect the
cable to it instead.

159
00:10:55,019 --> 00:10:58,309
What will happen when PC2 tries to ping R1?

160
00:10:58,309 --> 00:11:00,529
Here’s what happens.

161
00:11:00,529 --> 00:11:07,050
From the top of the output, the port status
has changed from secure-up to secure-shutdown.

162
00:11:07,050 --> 00:11:12,279
By the way, if you check SHOW INTERFACES STATUS,
you will the status err-disabled that I mentioned

163
00:11:12,279 --> 00:11:14,220
earlier.

164
00:11:14,220 --> 00:11:18,129
But in the SHOW PORT-SECURITY INTERFACE command,
it says secure-shutdown.

165
00:11:18,129 --> 00:11:22,829
Also, the total MAC addresses count has reset
to 0.

166
00:11:22,829 --> 00:11:28,189
So, it dynamically learned PC1’s MAC address
as a secure MAC address, but after the port

167
00:11:28,189 --> 00:11:30,999
was shutdown it was cleared.

168
00:11:30,999 --> 00:11:35,430
The last source address is PC2’s MAC address,
B.B.B.

169
00:11:35,430 --> 00:11:38,259
And the security violation count is now 1.

170
00:11:38,259 --> 00:11:44,129
Okay, so let’s see how to re-enable an interface
that has been disabled by port security.

171
00:11:44,129 --> 00:11:49,220
Okay, here’s how to manually re-enable the
interface.

172
00:11:49,220 --> 00:11:54,899
But before entering any commands, you should
first disconnect the unauthorized device.

173
00:11:54,899 --> 00:11:58,749
After disconnecting the unauthorized device,
you should then enter the commands on the

174
00:11:58,749 --> 00:11:59,999
interface.

175
00:11:59,999 --> 00:12:05,769
SHUTDOWN, which puts it in administratively
disabled mode, and then the NO SHUTDOWN to

176
00:12:05,769 --> 00:12:07,410
re-enable it.

177
00:12:07,410 --> 00:12:10,860
Let’s check out SHOW PORT-SECURITY INTERFACE.

178
00:12:10,860 --> 00:12:13,699
The port status is back to secure-up.

179
00:12:13,699 --> 00:12:19,100
The last source address, which was PC2’s
MAC address before, has been erased.

180
00:12:19,100 --> 00:12:23,410
And at the bottom, the security violation
count actually was reset too when the interface

181
00:12:23,410 --> 00:12:24,800
came back up.

182
00:12:24,800 --> 00:12:30,089
So, with the default violation mode, shutdown,
this security violation count shouldn’t

183
00:12:30,089 --> 00:12:31,540
go higher than 1.

184
00:12:31,540 --> 00:12:37,540
Now, there’s another way to re-enable an
err-disabled interface, that is ErrDisable

185
00:12:37,540 --> 00:12:39,070
recovery.

186
00:12:39,070 --> 00:12:45,490
It causes err-disabled interfaces to be automatically
re-enabled after a certain period of time.

187
00:12:45,490 --> 00:12:49,889
There are actually various reasons an interface
can enter an err-disabled state.

188
00:12:49,889 --> 00:12:54,949
I used the command SHOW ERRDISABLE RECOVERY,
which lists all of them.

189
00:12:54,949 --> 00:13:00,939
There are so many that I had to omit a lot
of them, the output doesn’t fit on one screen.

190
00:13:00,939 --> 00:13:06,059
On the left is each err-disable reason, and
on the right it will show whether or not err-disable

191
00:13:06,059 --> 00:13:08,560
recovery is enabled.

192
00:13:08,560 --> 00:13:14,649
By default, it is disabled for all reasons,
so err-disabled interfaces will not be automatically

193
00:13:14,649 --> 00:13:15,829
recovered.

194
00:13:15,829 --> 00:13:22,209
The one we’re looking for is psecure-violation,
that means port-security violation.

195
00:13:22,209 --> 00:13:24,800
Notice the default timer is 300 seconds.

196
00:13:24,800 --> 00:13:31,940
So, every 5 minutes by default, all err-disabled
interfaces will re-enabled, but only if err-disable

197
00:13:31,940 --> 00:13:36,200
recovery has been enabled for the cause of
the interface’s disablement.

198
00:13:36,200 --> 00:13:40,470
So, let’s enable it for port security violations.

199
00:13:40,470 --> 00:13:42,959
Here’s how to enable it.

200
00:13:42,959 --> 00:13:48,880
The command is ERRDISABLE RECOVERY CAUSE,
followed by the cause, which is PSECURE-VIOLATION

201
00:13:48,880 --> 00:13:50,660
in this case.

202
00:13:50,660 --> 00:13:56,110
And just to demonstrate the command, I shortened
the timer with ERRDISABLE RECOVERY INTERVAL,

203
00:13:56,110 --> 00:13:58,870
and then specified 180 seconds.

204
00:13:58,870 --> 00:14:02,529
Here’s SHOW ERRDISABLE RECOVERY again.

205
00:14:02,529 --> 00:14:07,489
Notice that the psecure-violation recovery
timer is now enabled, and the timer interval

206
00:14:07,489 --> 00:14:11,110
is 180 seconds, as configured.

207
00:14:11,110 --> 00:14:16,620
And just to demonstrate I caused G0/1 to become
errdisabled again, and you can see that it

208
00:14:16,620 --> 00:14:21,639
will be enabled at the next timeout, and there
are 149 seconds left.

209
00:14:21,639 --> 00:14:26,889
So, this is a useful feature, but it’s useless
if you don’t remove the device that caused

210
00:14:26,889 --> 00:14:29,499
the interface to enter the err-disabled state.

211
00:14:29,499 --> 00:14:32,929
So, that will always be step 1.

212
00:14:32,929 --> 00:14:37,390
Disconnect the unauthorized device, and then
either manually re-enable the interface, or

213
00:14:37,390 --> 00:14:41,600
let errdisable recovery do it for you automatically.

214
00:14:41,600 --> 00:14:45,019
What will happen if you don’t disconnect
the unauthorized device?

215
00:14:45,019 --> 00:14:50,010
Well, if you manually configured the secure
MAC address, the interface will simply become

216
00:14:50,010 --> 00:14:55,190
disabled again when it receives another frame
from the unauthorized device.

217
00:14:55,190 --> 00:14:59,489
But if you let the switch dynamically learn
the previous secure MAC address, it is cleared

218
00:14:59,489 --> 00:15:02,009
when the interface is disabled.

219
00:15:02,009 --> 00:15:06,720
When the interface is re-enabled, the unauthorized
device’s MAC address might become the new

220
00:15:06,720 --> 00:15:11,709
secure MAC address on the interface, which
is obviously not a good situation.

221
00:15:11,709 --> 00:15:15,929
So, remember to disconnect the unauthorized
device.

222
00:15:15,929 --> 00:15:19,730
Okay, now let’s talk about those violation
modes.

223
00:15:19,730 --> 00:15:24,820
I just showed you the default mode, shutdown,
and how to re-enable an interface shutdown

224
00:15:24,820 --> 00:15:27,019
by port security.

225
00:15:27,019 --> 00:15:30,889
But there are three different violation modes
that determine what the switch will do if

226
00:15:30,889 --> 00:15:35,769
an unauthorized frame enters an interface
configured with port security.

227
00:15:35,769 --> 00:15:38,269
The first is the default, shutdown.

228
00:15:38,269 --> 00:15:43,569
It effectively shuts down the port by placing
it in an err-disabled state if an unauthorized

229
00:15:43,569 --> 00:15:46,029
frame enters the port.

230
00:15:46,029 --> 00:15:51,299
It will also generate a Syslog and/or SNMP
message to let you know that port security

231
00:15:51,299 --> 00:15:53,339
disabled the interface.

232
00:15:53,339 --> 00:15:59,810
However, after the interface is down it won’t
continue generating messages even if the unauthorized

233
00:15:59,810 --> 00:16:03,189
device continues trying to send traffic.

234
00:16:03,189 --> 00:16:07,759
Only one message is generated to say that
the port was disabled.

235
00:16:07,759 --> 00:16:12,240
The violation counter is set to 1 when the
interface is disabled, although it will be

236
00:16:12,240 --> 00:16:16,639
reset to 0 when the interface is re-enabled,
as you saw before.

237
00:16:16,639 --> 00:16:20,309
Okay, the next violation mode is restrict.

238
00:16:20,309 --> 00:16:23,899
The switch will discard traffic from unauthorized
MAC addresses.

239
00:16:23,899 --> 00:16:27,430
However, the interface is not disabled.

240
00:16:27,430 --> 00:16:32,129
Devices with authorized MAC addresses will
still be able to use the interface.

241
00:16:32,129 --> 00:16:37,559
The switch generates a syslog and/or SNMP
message each time an unauthorized MAC address

242
00:16:37,559 --> 00:16:39,279
is detected.

243
00:16:39,279 --> 00:16:43,420
And the violation counter is incremented by
1 for each unauthorized frame.

244
00:16:43,420 --> 00:16:47,209
Okay, that’s restrict mode, now the last
one.

245
00:16:47,209 --> 00:16:48,629
Protect mode.

246
00:16:48,629 --> 00:16:53,739
Like restrict mode, the switch discards traffic
from unauthorized MAC addresses, and the interface

247
00:16:53,739 --> 00:16:55,249
is not disabled.

248
00:16:55,249 --> 00:17:01,170
However, it does not generate syslog or SNMP
messages for unauthorized traffic.

249
00:17:01,170 --> 00:17:04,120
And it doesn’t increment the violation counter
either.

250
00:17:04,120 --> 00:17:07,030
It just silently discards unauthorized traffic.

251
00:17:07,030 --> 00:17:12,610
Okay, so we already saw the shutdown mode,
let’s look at the other two.

252
00:17:12,610 --> 00:17:15,870
Here’s the restrict violation mode.

253
00:17:15,870 --> 00:17:22,160
I’m starting from a fresh port-security
configuration, so first I enable port-security.

254
00:17:22,160 --> 00:17:28,210
This time, I manually authorized PC1’s MAC
address with SWITCHPORT PORT-SECURITY MAC-ADDRESS,

255
00:17:28,210 --> 00:17:30,180
followed by PC1’s MAC address.

256
00:17:30,180 --> 00:17:33,880
And here’s how to enable restrict mode.

257
00:17:33,880 --> 00:17:37,480
SWITCHPORT PORT-SECURITY VIOLATION RESTRICT.

258
00:17:37,480 --> 00:17:43,120
Then I tried to ping R1 from PC2, and I got
a bunch of syslog messages like this, which

259
00:17:43,120 --> 00:17:49,140
tells us that a security violation occurred,
caused by PC2’s MAC address, on the G0/1

260
00:17:49,140 --> 00:17:50,140
interface.

261
00:17:50,140 --> 00:17:53,770
Let’s check SHOW PORT-SECURITY INTERFACE.

262
00:17:53,770 --> 00:17:57,710
First, notice the violation mode of restrict.

263
00:17:57,710 --> 00:18:01,740
And you can see that the violation count has
gone to twelve because I tried to send traffic

264
00:18:01,740 --> 00:18:02,740
from PC2.

265
00:18:02,740 --> 00:18:07,500
However, the port status is secure-up, not
secure-shutdown.

266
00:18:07,500 --> 00:18:13,070
So, if I were to connect the cable back to
PC1, it would still be able to send traffic,

267
00:18:13,070 --> 00:18:18,510
no problem, because the interface is still
up and PC1’s MAC address is authorized.

268
00:18:18,510 --> 00:18:21,470
Okay, that’s the restrict violation mode.

269
00:18:21,470 --> 00:18:24,710
And here’s the last one, protect.

270
00:18:24,710 --> 00:18:29,890
We’re starting with a fresh configuration
again for this example, so make sure to enable

271
00:18:29,890 --> 00:18:30,890
port security.

272
00:18:30,890 --> 00:18:34,820
I once again manually authorized PC1’s MAC
address.

273
00:18:34,820 --> 00:18:39,510
And then I configured SWITCHPORT PORT-SECURITY
VIOLATION PROTECT.

274
00:18:39,510 --> 00:18:41,930
And then sent some traffic from PC2.

275
00:18:41,930 --> 00:18:47,150
PC2’s pings failed, but there were no syslog
messages on SW1.

276
00:18:47,150 --> 00:18:49,730
Let’s check this command again.

277
00:18:49,730 --> 00:18:54,860
The port status is secure-up, the violation
mode is protect, and the violation counter

278
00:18:54,860 --> 00:18:56,050
is 0.

279
00:18:56,050 --> 00:19:02,450
So, SW1 discarded the traffic from PC2, but
didn’t display any syslog messages or increment

280
00:19:02,450 --> 00:19:03,990
the violation count.

281
00:19:03,990 --> 00:19:06,780
That’s the protect violation mode.

282
00:19:06,780 --> 00:19:11,860
OK, here’s that summary of the violation
modes again.

283
00:19:11,860 --> 00:19:17,310
These are how you control what the switch
does when a port-security violation occurs.

284
00:19:17,310 --> 00:19:21,280
You should definitely learn the actions taken
by each violation mode, and remember that

285
00:19:21,280 --> 00:19:24,260
shutdown is the default mode.

286
00:19:24,260 --> 00:19:29,830
Okay, moving down to the next part of the
SHOW PORT-SECURITY INTERFACE command, let’s

287
00:19:29,830 --> 00:19:32,850
check out secure MAC address aging.

288
00:19:32,850 --> 00:19:37,330
By the way, MAC addresses dynamically learned
or statically configured on a port-security

289
00:19:37,330 --> 00:19:41,580
enabled port are called secure MAC addresses.

290
00:19:41,580 --> 00:19:44,920
By default, secure MAC addresses will not
age out.

291
00:19:44,920 --> 00:19:49,600
There is no timer, they are permanent unless
you manually delete the learned MAC address

292
00:19:49,600 --> 00:19:52,310
or the port is disabled and then re-enabled.

293
00:19:52,310 --> 00:19:56,180
That’s what the aging time of 0 minutes
means.

294
00:19:56,180 --> 00:20:01,150
However, you can configure this timer with
the command SWITCHPORT PORT-SECURITY AGING

295
00:20:01,150 --> 00:20:04,200
TIME, and then the time in minutes.

296
00:20:04,200 --> 00:20:09,310
If you do configure an aging time, the default
aging type is absolute.

297
00:20:09,310 --> 00:20:11,260
Let me explain what that means.

298
00:20:11,260 --> 00:20:16,950
Absolute aging means that, after the secure
MAC address is learned, the aging timer starts

299
00:20:16,950 --> 00:20:21,930
and the MAC address is removed after the timer
expires, even if the switch continues receiving

300
00:20:21,930 --> 00:20:26,180
frames from that source MAC address while
it is counting down.

301
00:20:26,180 --> 00:20:31,760
However, after the MAC address ages out it
can then immediately be re-learned if another

302
00:20:31,760 --> 00:20:35,450
frame with that source MAC is received.

303
00:20:35,450 --> 00:20:38,120
The other aging type is inactivity.

304
00:20:38,120 --> 00:20:41,180
This is like regular MAC address aging.

305
00:20:41,180 --> 00:20:45,670
After the MAC address is learned the aging
timer starts, but it is reset every time a

306
00:20:45,670 --> 00:20:48,860
frame from that source MAC address is received.

307
00:20:48,860 --> 00:20:55,470
So, if the switch keeps receiving frames from
that MAC address, it will never be aged out.

308
00:20:55,470 --> 00:21:00,900
You can configure the aging type with SWITCHPORT
PORT-SECURITY AGING TYPE, and then absolute

309
00:21:00,900 --> 00:21:02,630
or inactivity.

310
00:21:02,630 --> 00:21:08,670
Now, by default only dynamically-learned secure
MAC addresses will age out.

311
00:21:08,670 --> 00:21:14,050
If you configure a MAC with SWITCHPORT PORT-SECURITY
MAC-ADDRESS, which I showed you earlier, it

312
00:21:14,050 --> 00:21:15,260
won’t age out.

313
00:21:15,260 --> 00:21:19,371
The command will remain in the running-config
and the MAC will remain in the MAC address

314
00:21:19,371 --> 00:21:21,080
table.

315
00:21:21,080 --> 00:21:26,110
But with the command SWITCHPORT PORT-SECURITY
AGING STATIC, you can make the switch age

316
00:21:26,110 --> 00:21:29,140
out static secure MAC addresses, too.

317
00:21:29,140 --> 00:21:33,240
The command will be removed from the running
config and the address will be removed from

318
00:21:33,240 --> 00:21:37,140
the MAC address table if it ages out.

319
00:21:37,140 --> 00:21:38,850
Let me show you those commands in the CLI.

320
00:21:38,850 --> 00:21:45,420
I configured an aging time of 30 minutes,
aging type of inactivity, and enabled aging

321
00:21:45,420 --> 00:21:48,580
of static secure MAC addresses.

322
00:21:48,580 --> 00:21:53,620
Then I checked SHOW PORT-SECURITY INTERFACE
G0/1 again, and you can see the output has

323
00:21:53,620 --> 00:21:55,520
changed now.

324
00:21:55,520 --> 00:22:01,470
Aging time 30 minutes, aging type inactivity,
and securestatic address aging enabled.

325
00:22:01,470 --> 00:22:05,740
Okay, that’s all you really need to know
about the timers.

326
00:22:05,740 --> 00:22:10,270
But before moving on to the next topic, let
me show you one more useful command.

327
00:22:10,270 --> 00:22:12,610
SHOW PORT-SECURITY.

328
00:22:12,610 --> 00:22:17,830
It displays which interfaces have port security
enabled, the max and current number of secure

329
00:22:17,830 --> 00:22:24,010
addresses on those interfaces, their security
violation count, and their security action.

330
00:22:24,010 --> 00:22:28,690
In this case, I only have port security enabled
on one port, but if you have it enabled on

331
00:22:28,690 --> 00:22:34,320
many this is a useful command to get an overview
of your port security enabled interfaces.

332
00:22:34,320 --> 00:22:41,660
Next, here’s the last major topic of the
video, sticky secure MAC addresses.

333
00:22:41,660 --> 00:22:45,570
Sticky secure MAC address learning can be
enabled with the following command.

334
00:22:45,570 --> 00:22:49,500
SWITCHPORT PORT-SECURITY MAC-ADDRESS STICKY.

335
00:22:49,500 --> 00:22:54,010
When enabled, dynamically-learned secure MAC
addresses will be added to the running config

336
00:22:54,010 --> 00:22:55,080
like this.

337
00:22:55,080 --> 00:23:00,710
So, if you look in the running config you’ll
see a command like this automatically added,

338
00:23:00,710 --> 00:23:06,070
SWITCHPORT PORT-SECURITY MAC-ADDRESS STICKY,
and then the learned MAC address.

339
00:23:06,070 --> 00:23:10,470
These sticky secure MAC addresses will never
age out, even if you enable static secure

340
00:23:10,470 --> 00:23:12,130
MAC address aging.

341
00:23:12,130 --> 00:23:17,370
However, because they are added to the running-config,
not the startup-config, you’ll need to save

342
00:23:17,370 --> 00:23:22,120
the running-config to the startup-config to
make them truly permanent, for example with

343
00:23:22,120 --> 00:23:24,730
the WRITE MEMORY command.

344
00:23:24,730 --> 00:23:29,320
If you don’t do that, they will be lost
if the switch restarts, or is turned off and

345
00:23:29,320 --> 00:23:31,280
then on again.

346
00:23:31,280 --> 00:23:36,620
When you issue the SWITCHPORT PORT-SECURITY
MAC-ADDRESS sticky command, all current dynamically-learned

347
00:23:36,620 --> 00:23:40,850
secure MAC addresses will be converted to
sticky secure MAC addresses.

348
00:23:40,850 --> 00:23:44,470
So, they will be added to the running config.

349
00:23:44,470 --> 00:23:46,290
The opposite is true, too.

350
00:23:46,290 --> 00:23:50,560
If you remove sticky learning, sticky secure
MAC addresses will be converted to regular

351
00:23:50,560 --> 00:23:52,500
dynamic secure MAC addresses.

352
00:23:52,500 --> 00:23:56,310
Okay, let’s check it out in the CLI.

353
00:23:56,310 --> 00:24:00,600
So, as always I enabled port-security first.

354
00:24:00,600 --> 00:24:07,940
Then I issued SWITCHPORT PORT-SECURITY MAC-ADDRESS
STICKY, and sent a ping from PC1 to R1.

355
00:24:07,940 --> 00:24:15,090
I then checked the G0/1 interface in the running-config,
and as you can see an extra command was added.

356
00:24:15,090 --> 00:24:19,380
SWITCHPORT PORT-SECURITY MAC-ADDRESS STICKY,
and then PC1’s MAC address.

357
00:24:19,380 --> 00:24:24,630
I didn’t configure that command, it was
added automatically when PC1’s frame entered

358
00:24:24,630 --> 00:24:25,970
the interface.

359
00:24:25,970 --> 00:24:32,100
So, sticky MAC addresses are basically a way
of configuring static secure MAC addresses,

360
00:24:32,100 --> 00:24:34,150
without actually having to manually configure
them

361
00:24:34,150 --> 00:24:41,710
Okay, before moving on to review and the quiz,
let me briefly mention the MAC address table.

362
00:24:41,710 --> 00:24:46,950
Secure MAC addresses will be added to the
MAC address table like any other MAC address.

363
00:24:46,950 --> 00:24:52,360
Sticky and static secure MAC addresses will
have a type of static, and regular dynamically-learned

364
00:24:52,360 --> 00:24:57,370
secure MAC addresses that aren’t sticky
will have a type of dynamic.

365
00:24:57,370 --> 00:25:03,250
And you can view all secure MAC addresses
in the table with SHOW MAC ADDRESS-TABLE SECURE.

366
00:25:03,250 --> 00:25:07,950
I used the command, and here is PC1’s MAC
address from the previous sticky MAC address

367
00:25:07,950 --> 00:25:09,490
example.

368
00:25:09,490 --> 00:25:13,490
Notice the type of static, even though I didn’t
actually statically configure it myself.

369
00:25:13,490 --> 00:25:16,030
It was dynamically learned.

370
00:25:16,030 --> 00:25:19,460
Here’s a summary of the commands we covered
in this video.

371
00:25:19,460 --> 00:25:21,180
Lots of new commands!

372
00:25:21,180 --> 00:25:25,730
You’ll definitely want to experiment with
these commands in a lab.

373
00:25:25,730 --> 00:25:29,730
Follow my packet tracer lab, and also try
making your own.

374
00:25:29,730 --> 00:25:34,940
If you don’t remember any of these commands,
go back in the video to review.

375
00:25:34,940 --> 00:25:38,800
Before moving on to the quiz, let’s review
what we learned.

376
00:25:38,800 --> 00:25:42,690
First I gave an intro to port security, and
explained its basic function.

377
00:25:42,690 --> 00:25:48,040
Basically, it allows you to control what source
MAC addresses, and how many source MAC addresses,

378
00:25:48,040 --> 00:25:50,380
are allowed to enter a switch interface.

379
00:25:50,380 --> 00:25:55,000
I also briefly explained why we should use
port security.

380
00:25:55,000 --> 00:25:59,690
First of all, it allows us to prevent unauthorized
devices from accessing the network.

381
00:25:59,690 --> 00:26:04,410
And secondly, it helps defend against attacks
such as the DHCP exhaustion attack I showed

382
00:26:04,410 --> 00:26:09,880
in a previous video, in which thousands of
spoofed MAC addresses are used to send DHCP

383
00:26:09,880 --> 00:26:11,460
discover messages.

384
00:26:11,460 --> 00:26:16,700
Then, while explaining various aspects of
port security, I also showed you how to configure

385
00:26:16,700 --> 00:26:18,240
it.

386
00:26:18,240 --> 00:26:22,470
Make sure to watch until the end of the quiz
for a bonus question from Boson Software’s

387
00:26:22,470 --> 00:26:26,080
ExSim, my recommended practice exams for the
CCNA.

388
00:26:26,080 --> 00:26:31,280
Okay, let’s go to quiz question 1.

389
00:26:31,280 --> 00:26:33,730
Examine the show command output below.

390
00:26:33,730 --> 00:26:37,060
How many secure MAC addresses were dynamically
learned on the interface?

391
00:26:37,060 --> 00:26:43,490
Pause the video now to examine the output
and select the best answer.

392
00:26:43,490 --> 00:26:48,230
Okay, the answer is C, 3.

393
00:26:48,230 --> 00:26:53,200
So, according to the output 4 total MAC addresses
have been learned on the interface.

394
00:26:53,200 --> 00:26:56,830
1 was configured, that’s not dynamic.

395
00:26:56,830 --> 00:27:00,610
There are 3 sticky MAC addresses, what about
them?

396
00:27:00,610 --> 00:27:04,800
Although sticky MAC addresses are inserted
into the running config like a static MAC

397
00:27:04,800 --> 00:27:10,090
address, and their type in the MAC address
table is STATIC, they are actually dynamically

398
00:27:10,090 --> 00:27:11,090
learned.

399
00:27:11,090 --> 00:27:16,360
So those 3 sticky MAC addresses were dynamically
learned, and the answer is C, 3.

400
00:27:16,360 --> 00:27:20,300
Let’s go to question 2.

401
00:27:20,300 --> 00:27:24,790
Which of the following occur when a port-security
violation occurs in restrict mode?

402
00:27:24,790 --> 00:27:32,620
(select the two best answers) Okay, pause
the video now to select the best answers.

403
00:27:32,620 --> 00:27:40,800
Okay, the best answers are B, unauthorized
traffic is discarded, and E, the violation

404
00:27:40,800 --> 00:27:42,500
counter is incremented.

405
00:27:42,500 --> 00:27:46,620
In addition, a syslog message and SNMP trap
will be sent.

406
00:27:46,620 --> 00:27:51,930
However, an SNMP Get message, as in D, will
not be sent.

407
00:27:51,930 --> 00:27:56,990
GET messages are sent from the SNMP manager
to the agent, not the agent to the manager.

408
00:27:56,990 --> 00:28:02,210
Okay, let’s go to question 3.

409
00:28:02,210 --> 00:28:03,800
Examine the following output.

410
00:28:03,800 --> 00:28:08,960
What will SW1 do when an unauthorized frame
arrives on G0/1?

411
00:28:08,960 --> 00:28:14,940
Pause the video now to examine the output
and select the best answer.

412
00:28:14,940 --> 00:28:21,900
Okay, the best answer is A, unauthorized traffic
will be dropped.

413
00:28:21,900 --> 00:28:26,650
The violation mode is protect, which means
that all unauthorized frames will be dropped.

414
00:28:26,650 --> 00:28:30,580
However, the interface won’t be err-disabled.

415
00:28:30,580 --> 00:28:32,800
Authorized frames will still be forwarded.

416
00:28:32,800 --> 00:28:37,580
No syslog or SNMP messages will be sent, and
the violation count won’t be incremented

417
00:28:37,580 --> 00:28:38,580
either.

418
00:28:38,580 --> 00:28:42,960
Okay, let’s go to question 4.

419
00:28:42,960 --> 00:28:47,500
Which of the following will re-enable an interface
that was disabled by port security?

420
00:28:47,500 --> 00:28:49,900
(select the two best answers).

421
00:28:49,900 --> 00:28:57,870
Okay, pause the video now to select the two
best answers.

422
00:28:57,870 --> 00:29:04,530
The best answers are A, SHUTDOWN and NO SHUTDOWN
on the interface, and B, ERRDISABLE RECOVERY

423
00:29:04,530 --> 00:29:08,330
CAUSE PSECURE-VIOLATION in global config mode.

424
00:29:08,330 --> 00:29:11,950
Either of these will work to re-enable the
interface.

425
00:29:11,950 --> 00:29:17,750
C, unplugging the unauthorized device, is
incorrect because that alone will not re-enable

426
00:29:17,750 --> 00:29:19,390
the interface.

427
00:29:19,390 --> 00:29:25,000
Note that, you should unplug the unauthorized
device before the steps in A or B, but disconnecting

428
00:29:25,000 --> 00:29:27,760
the device itself won’t re-enable the interface.

429
00:29:27,760 --> 00:29:33,220
Okay, let’s go to question 5.

430
00:29:33,220 --> 00:29:35,400
Examine the following output.

431
00:29:35,400 --> 00:29:40,650
What will happen when the switchport port-security
command is issued on G0/1?

432
00:29:40,650 --> 00:29:46,280
Pause the video now to examine the output
and select the correct answer.

433
00:29:46,280 --> 00:29:52,070
Okay, the answer is a, the command will be
accepted.

434
00:29:52,070 --> 00:29:57,810
The administrative mode of G0/1 is static
access, so port security can be enabled.

435
00:29:57,810 --> 00:30:03,000
However, if it was the default administrative
mode of dynamic auto, the command would be

436
00:30:03,000 --> 00:30:04,670
rejected.

437
00:30:04,670 --> 00:30:09,590
Port security can be configured on access
ports or trunk ports, but they must be statically

438
00:30:09,590 --> 00:30:13,540
configured with SWITCHPORT MODE ACCESS or
SWITCHPORT MODE TRUNK.

439
00:30:13,540 --> 00:30:16,360
Okay, that’s all for the quiz.

440
00:30:16,360 --> 00:30:21,606
Now let’s take a look at a bonus question
in Boson Software’s ExSim for CCNA.

441
00:33:00,640 --> 00:33:04,060
There are supplementary materials for this
video.

442
00:33:04,060 --> 00:33:08,100
There is a flashcard deck to use with the
software ‘Anki’.

443
00:33:08,100 --> 00:33:12,720
There will also be a packet tracer practice
lab, so you can get hands-on practice.

444
00:33:12,720 --> 00:33:16,309
That will be in the next video.

445
00:33:16,309 --> 00:33:20,830
Before finishing today’s video I want to
thank my JCNP-level channel members.

446
00:33:20,830 --> 00:33:25,280
To join, please click the ‘Join’ button
under the video.

447
00:33:25,280 --> 00:33:31,680
Thank you to Samil, C Mohd, Scott, Martin,
Khoa, Christopher, Tebogo, Anand, Pavel, Abraham,

448
00:33:31,680 --> 00:33:38,360
Serge, Njoku, Viktor, Roger, Suki, Kenneth,
Seamus, Brandon, Marcel, Kone, Donald, Gustavo,

449
00:33:38,360 --> 00:33:44,480
Prakaash, Nasir, Erlison, Marko, Daming, Ed,
John, Funnydart, Velvijaykum, Yousif, Boson

450
00:33:44,480 --> 00:33:47,070
Software, Devin, Yonatan, and Vance.

451
00:33:47,070 --> 00:33:52,440
Sorry if I pronounced your name incorrectly,
but thank you so much for your support.

452
00:33:52,440 --> 00:33:58,620
This is the list of JCNP-level members at
the time of recording by the way, May 26th

453
00:33:58,620 --> 00:33:59,620
2021.

454
00:33:59,620 --> 00:34:04,200
If you signed up recently and your name isn’t
on here don’t worry, you’ll be in future

455
00:34:04,200 --> 00:34:05,200
videos.

456
00:34:05,200 --> 00:34:08,290
Thank you for watching.

457
00:34:08,290 --> 00:34:12,200
Please subscribe to the channel, like the
video, leave a comment, and share the video

458
00:34:12,200 --> 00:34:15,530
with anyone else studying for the CCNA.

459
00:34:15,530 --> 00:34:18,380
If you want to leave a tip, check the links
in the description.

460
00:34:18,380 --> 00:34:24,290
I'm also a Brave verified publisher and accept
BAT, or Basic Attention Token, tips via the

461
00:34:24,290 --> 00:34:25,620
Brave browser.

462
00:34:25,620 --> 00:34:26,190
That's all for now.